Index: squid/helpers/ntlm_auth/SMB/libntlmssp.c
diff -c squid/helpers/ntlm_auth/SMB/libntlmssp.c:1.7.2.3 squid/helpers/ntlm_auth/SMB/libntlmssp.c:1.7.2.4
*** squid/helpers/ntlm_auth/SMB/libntlmssp.c:1.7.2.3	Sun Feb 20 12:07:44 2005
--- squid/helpers/ntlm_auth/SMB/libntlmssp.c	Sun Dec 11 03:23:02 2005
***************
*** 178,191 ****
--- 178,194 ----
      char *p = credentials;
      lstring tmp;
      tmp = ntlm_fetch_string((char *) auth, auth_length, &auth->domain);
+     *p = '\0';
      if (tmp.str == NULL)
  	return NULL;
      memcpy(p, tmp.str, tmp.l);
      p += tmp.l;
      *p++ = '\\';
+     *p = '\0';
      tmp = ntlm_fetch_string((char *) auth, auth_length, &auth->user);
      if (tmp.str == NULL)
  	return NULL;
+     memcpy(p, tmp.str, tmp.l);
      *(p + tmp.l) = '\0';
      return credentials;
  }
