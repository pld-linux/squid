Index: squid/src/http.c
diff -c squid/src/http.c:1.384.2.6 squid/src/http.c:1.384.2.7
*** squid/src/http.c:1.384.2.6	Fri Jul 11 16:40:34 2003
--- squid/src/http.c	Tue Jul 15 14:16:12 2003
***************
*** 906,911 ****
--- 906,915 ----
  	    if (strLen(request->urlpath))
  		assert(strstr(url, strBuf(request->urlpath)));
  	}
+ 	/* Set no-cache if determined needed but not found */
+ 	if (orig_request->flags.nocache && !httpHeaderHas(hdr_in, HDR_PRAGMA))
+ 	    EBIT_SET(cc->mask, CC_NO_CACHE);
+ 	/* Enforce sibling relations */
  	if (flags.only_if_cached)
  	    EBIT_SET(cc->mask, CC_ONLY_IF_CACHED);
  	httpHeaderPutCc(hdr_out, cc);
