Index: squid/lib/rfc1035.c
diff -c squid/lib/rfc1035.c:1.22.2.5 squid/lib/rfc1035.c:1.22.2.6
*** squid/lib/rfc1035.c:1.22.2.5	Sun Apr 11 03:14:52 2004
--- squid/lib/rfc1035.c	Sun Jan 16 19:00:30 2005
***************
*** 554,564 ****
  	    return -rfc1035_unpack_error;
  	}
      }
!     i = (int) hdr.ancount;
!     if (i == 0)
  	return 0;
!     recs = calloc(i, sizeof(*recs));
!     while (i--) {
  	if (off >= sz) {	/* corrupt packet */
  	    RFC1035_UNPACK_DEBUG;
  	    break;
--- 554,563 ----
  	    return -rfc1035_unpack_error;
  	}
      }
!     if (hdr.ancount == 0)
  	return 0;
!     recs = calloc((int)hdr.ancount, sizeof(*recs));
!     for (i = 0; i < (int)hdr.ancount; i++) {
  	if (off >= sz) {	/* corrupt packet */
  	    RFC1035_UNPACK_DEBUG;
  	    break;
