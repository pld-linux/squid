Index: squid/helpers/basic_auth/MSNT/smbencrypt.c
diff -c squid/helpers/basic_auth/MSNT/smbencrypt.c:1.1.2.3 squid/helpers/basic_auth/MSNT/smbencrypt.c:1.1.2.4
*** squid/helpers/basic_auth/MSNT/smbencrypt.c:1.1.2.3	Wed Mar  9 07:28:32 2005
--- squid/helpers/basic_auth/MSNT/smbencrypt.c	Wed Mar  9 07:33:01 2005
***************
*** 194,209 ****
  	    } else if (is_kana(*s)) {
  		s++;
  	    } else {
! 		if (islower(*s))
! 		    *s = toupper(*s);
  		s++;
  	    }
  	} else
  #endif /* KANJI_WIN95_COMPATIBILITY */
  #endif /* UNUSED_CODE */
  	{
! 	    if (islower(*s))
! 		*s = toupper(*s);
  	    s++;
  	}
      }
--- 194,209 ----
  	    } else if (is_kana(*s)) {
  		s++;
  	    } else {
! 		if (islower((int)(unsigned char)*s))
! 		    *s = toupper((int)(unsigned char)*s);
  		s++;
  	    }
  	} else
  #endif /* KANJI_WIN95_COMPATIBILITY */
  #endif /* UNUSED_CODE */
  	{
! 	    if (islower((int)(unsigned char)*s))
! 		*s = toupper((int)(unsigned char)*s);
  	    s++;
  	}
      }
Index: squid/helpers/ntlm_auth/SMB/smbval/smbencrypt.c
diff -c squid/helpers/ntlm_auth/SMB/smbval/smbencrypt.c:1.3.2.1 squid/helpers/ntlm_auth/SMB/smbval/smbencrypt.c:1.3.2.2
*** squid/helpers/ntlm_auth/SMB/smbval/smbencrypt.c:1.3.2.1	Wed Mar  9 07:28:32 2005
--- squid/helpers/ntlm_auth/SMB/smbval/smbencrypt.c	Wed Mar  9 07:33:01 2005
***************
*** 199,205 ****
  	 * else
  	 * #endif *//* KANJI_WIN95_COMPATIBILITY */
  	{
! 	    if (islower(*s))
  		*s = toupper(*s);
  	    s++;
  	}
--- 199,205 ----
  	 * else
  	 * #endif *//* KANJI_WIN95_COMPATIBILITY */
  	{
! 	    if (islower((int)(unsigned char)*s))
  		*s = toupper(*s);
  	    s++;
  	}
Index: squid/helpers/ntlm_auth/fakeauth/fakeauth_auth.c
diff -c squid/helpers/ntlm_auth/fakeauth/fakeauth_auth.c:1.3.2.7 squid/helpers/ntlm_auth/fakeauth/fakeauth_auth.c:1.3.2.8
*** squid/helpers/ntlm_auth/fakeauth/fakeauth_auth.c:1.3.2.7	Fri Jan  7 14:12:27 2005
--- squid/helpers/ntlm_auth/fakeauth/fakeauth_auth.c	Wed Mar  9 07:33:01 2005
***************
*** 177,183 ****
  	d = buf;
  
  	for (; l; l--) {
! 	    if (*sc == '\0' || !isprint(*sc)) {
  		fprintf(stderr, "ntlmGetString: bad ascii: %04x\n", *sc);
  		return (NULL);
  	    }
--- 177,183 ----
  	d = buf;
  
  	for (; l; l--) {
! 	    if (*sc == '\0' || !isprint((int)(unsigned char)*sc)) {
  		fprintf(stderr, "ntlmGetString: bad ascii: %04x\n", *sc);
  		return (NULL);
  	    }
Index: squid/include/config.h
diff -c squid/include/config.h:1.4.2.2 squid/include/config.h:1.4.2.4
*** squid/include/config.h:1.4.2.2	Sun Feb 20 04:02:56 2005
--- squid/include/config.h	Thu Mar 10 16:37:50 2005
***************
*** 162,167 ****
--- 162,168 ----
  #define xisdigit(x) isdigit((unsigned char)x)
  #define xisascii(x) isascii((unsigned char)x)
  #define xislower(x) islower((unsigned char)x)
+ #define xisupper(x) isupper((unsigned char)x)
  #define xisalpha(x) isalpha((unsigned char)x)
  #define xisalnum(x) isalnum((unsigned char)x)
  #define xisgraph(x) isgraph((unsigned char)x)
Index: squid/snmplib/mib.c
diff -c squid/snmplib/mib.c:1.22 squid/snmplib/mib.c:1.22.2.1
*** squid/snmplib/mib.c:1.22	Wed Nov 28 01:01:46 2001
--- squid/snmplib/mib.c	Wed Mar  9 07:33:02 2005
***************
*** 127,137 ****
      char c1, c2;
  
      while (*s1 && *s2) {
! 	if (isupper(*s1))
  	    c1 = tolower(*s1);
  	else
  	    c1 = *s1;
! 	if (isupper(*s2))
  	    c2 = tolower(*s2);
  	else
  	    c2 = *s2;
--- 127,137 ----
      char c1, c2;
  
      while (*s1 && *s2) {
! 	if (xisupper(*s1))
  	    c1 = tolower(*s1);
  	else
  	    c1 = *s1;
! 	if (xisupper(*s2))
  	    c2 = tolower(*s2);
  	else
  	    c2 = *s2;
***************
*** 163,173 ****
  	(*input == '.'))
  	return (0);
  
!     if (isdigit(*input)) {
  	/*
  	 * Read the number, then try to find it in the subtree.
  	 */
! 	while (isdigit(*input)) {
  	    subid *= 10;
  	    subid += *input++ - '0';
  	}
--- 163,173 ----
  	(*input == '.'))
  	return (0);
  
!     if (xisdigit(*input)) {
  	/*
  	 * Read the number, then try to find it in the subtree.
  	 */
! 	while (xisdigit(*input)) {
  	    subid *= 10;
  	    subid += *input++ - '0';
  	}
Index: squid/snmplib/parse.c
diff -c squid/snmplib/parse.c:1.26 squid/snmplib/parse.c:1.26.2.1
*** squid/snmplib/parse.c:1.26	Wed Oct 17 13:05:37 2001
--- squid/snmplib/parse.c	Wed Mar  9 07:33:02 2005
***************
*** 540,546 ****
  		return get_token(fp, token);
  	    }
  	    for (cp = token; *cp; cp++)
! 		if (!isdigit(*cp))
  		    return LABEL;
  	    return NUMBER;
  	} else {
--- 540,546 ----
  		return get_token(fp, token);
  	    }
  	    for (cp = token; *cp; cp++)
! 		if (!xisdigit(*cp))
  		    return LABEL;
  	    return NUMBER;
  	} else {
