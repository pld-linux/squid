Index: squid/lib/rfc1035.c
diff -c squid/lib/rfc1035.c:1.22.2.3 squid/lib/rfc1035.c:1.22.2.4
*** squid/lib/rfc1035.c:1.22.2.3	Wed Apr 10 15:33:21 2002
--- squid/lib/rfc1035.c	Fri Apr 25 06:09:57 2003
***************
*** 345,351 ****
  	    *(name + (no++)) = '.';
  	}
      } while (c > 0 && no < ns);
!     *(name + no - 1) = '\0';
      /* make sure we didn't allow someone to overflow the name buffer */
      assert(no <= ns);
      return 0;
--- 345,354 ----
  	    *(name + (no++)) = '.';
  	}
      } while (c > 0 && no < ns);
!     if (no)
! 	*(name + no - 1) = '\0';
!     else
! 	*name = '\0';
      /* make sure we didn't allow someone to overflow the name buffer */
      assert(no <= ns);
      return 0;
