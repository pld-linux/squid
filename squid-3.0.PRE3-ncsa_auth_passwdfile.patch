Index: squid3/helpers/basic_auth/NCSA/ncsa_auth.c
diff -c squid3/helpers/basic_auth/NCSA/ncsa_auth.c:1.4 squid3/helpers/basic_auth/NCSA/ncsa_auth.c:1.5
*** squid3/helpers/basic_auth/NCSA/ncsa_auth.c:1.4	Wed May 28 16:42:32 2003
--- squid3/helpers/basic_auth/NCSA/ncsa_auth.c	Wed Aug 20 06:59:24 2003
***************
*** 81,86 ****
--- 81,90 ----
  	exit(1);
      }
      f = fopen(passwdfile, "r");
+     if (NULL == f) {
+ 	fprintf(stderr, "%s: %s\n", passwdfile, xstrerror());
+ 	exit(1);
+     }
      while (fgets(buf, 8192, f) != NULL) {
  	if ((buf[0] == '#') || (buf[0] == ' ') || (buf[0] == '\t') ||
  	    (buf[0] == '\n'))
