Index: squid/helpers/external_acl/wbinfo_group/wbinfo_group.pl
diff -c squid/helpers/external_acl/wbinfo_group/wbinfo_group.pl:1.1.2.2 squid/helpers/external_acl/wbinfo_group/wbinfo_group.pl:1.1.2.3
*** squid/helpers/external_acl/wbinfo_group/wbinfo_group.pl:1.1.2.2	Tue Feb 17 15:37:51 2004
--- squid/helpers/external_acl/wbinfo_group/wbinfo_group.pl	Wed Jun 29 14:34:14 2005
***************
*** 15,20 ****
--- 15,23 ----
  #   2002-07-05 Jerry Murdock <jmurdock@itraktech.com>
  #		Initial release
  #
+ #   2005-06-28 Arno Streuli <astreuli@gmail.com>
+ #               Add multi group check
+ 
  
  # external_acl uses shell style lines in it's protocol
  require 'shellwords.pl';
***************
*** 47,54 ****
  while (<STDIN>) {
          chop;
  	&debug ("Got $_ from squid");
!         ($user, $group) = &shellwords;
! 	$ans = &check($user, $group);
  	&debug ("Sending $ans to squid");
  	print "$ans\n";
  }
--- 50,61 ----
  while (<STDIN>) {
          chop;
  	&debug ("Got $_ from squid");
! 	($user, @groups) = &shellwords;
! 	# test for each group squid send in it's request
! 	foreach $group (@groups) {
! 		$ans = &check($user, $group);
! 		last if $ans eq "OK";
! 	}
  	&debug ("Sending $ans to squid");
  	print "$ans\n";
  }
